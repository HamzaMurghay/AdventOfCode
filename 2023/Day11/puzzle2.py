import re

sstring = """.....#.......................#................#............#........#..........................................#.......#....................
.........................................................................#.................#........................................#.......
............#...........................#..........................................................................#........................
..#..................................................#......................................................................................
......................#............#...........................................#..................#.........................#............#..
................................................#...........................................................................................
..............................#............................#...........................................................#....................
......................................#...............................#.....................................................................
........................#......................................................................................#...........................#
............#.............................................................#..................#...........#......................#...........
#...........................................................................................................................................
.....#..............#......#........................#..........#...........................................................#................
.................................#...................................#.................#..............................#.....................
..........#................................#................................................................................................
.........................................................................#..................#...............................................
...#.....................................................................................................#............................#.....
...............#............#....................#.................................................#........................................
.......#..............#....................................#..........#........................................#.............#..............
......................................................................................................................#...........#.........
...............................#...........................................#................................................................
...................#..................................................................................#.....................................
....................................................#.........#..................................................#..........................
............................................#....................................#...............#........................................#.
........................................................................................#...................................................
...........#.........#..............#.............................................................................................#.........
...........................#................................................................................#...............................
.....#........................................................................#..............#.........................#....................
...............................................#.............#.........................................................................#....
.....................................................#.............................................#..........................#.............
..#.................#................................................#............#.....#......................#............................
...............#.......................#....................................#..................#............................................
..................................................#.........................................................................................
.............................#..........................#........#..........................................#...............#............#..
..........#..............................................................#..........................................................#.......
.....................................................................................................................#......................
...#.................................................#...................................#..................................................
..............#.................#.....#................................................................................................#....
....................#........................#.......................................................#......................................
...........................................................#.......#..............#............................#............................
...........#................................................................................#...............................................
...........................#...........................................................................................#....................
.....#....................................#...........................#.....#...............................................................
....................................................#.................................#.....................................................
................................................................................................#.....................................#.....
......................................#..........................................#.............................................#............
........................#......#.......................#...................................#...............#..........#.....................
..................#............................................#...................................#........................................
...............................................................................................................#..................#.........
.......#...........................#.......#......#.................#......................................................................#
..........................#.......................................................#.........................................................
...#......................................................................#...................#.............................................
........................................#..................#..............................................#.............#...................
.......................................................................................#.........................#...............#..........
............................................................................................................................................
.............#......#..........#................#...........................................#...............................................
..................................................................#...............................#.........................................
............................................................................................................................................
................#..........#.......#...............................................#............................#........................#..
#.........#...............................................................................#.................................................
........................................#.................................................................................#.................
.....#.............#................................#...................#..............................#...........#........................
.........................#..................................#...............................................................................
...............................................................................#................................................#......#....
.....................................................................................#......................................................
...........#......................#....................#.....................................#.............................................#
#.................#...............................................#......................................................#.........#........
.............................................#...............#..............#...............................................................
........................................#..........................................................#.............#......................#...
.........#.....................#..........................................................#.................................................
..................................................#..................................#...............................#......................
....................................#...................#...................................................................................
.............#................................................................#.............................................................
......................#..............................................#........................................#..........#..................
.............................................................#...........................................................................#..
#.........................................#........................................#...............#.....#....................#.............
.....#.............................#.............#.......................#.................#.......................#...............#........
.................................................................#.............#............................................................
...............#............................................................................................................................
........................................#............................#......................................................................
...........................................................#..........................#...........#..............................#..........
.#....................#.............................................................................................#.......................
............................................................................................................................................
..............................................#............................................#..............................................#.
...........#................................................................................................#................#..............
............................................................#.........#................#..............................#.....................
..#....................................................................................................................................#....
..................................#............................................................#.....#......................................
............................#..............................................................................................#.......#........
......#..........#..........................................................................................................................
...............................................................#................................................#...........................
........................................#.............#..............................#........................................#............#
..........................#..........................................#......#........................................#......................
#...........#.................................#.............................................................................................
............................................................................................................................................
..............................................................................................#..........#.............................#....
.....................#.................................................................#....................................................
...#....................................................................#.......................................#............#..............
..........................#..........#.......................#.....................................................................#........
...........................................#......................#.........#............................................................#..
#.................#....................................#...........................#..............#.........................................
................................................#........................................................................#..................
....#.............................#...................................#.....................................................................
.............#..............................................#.................................................................#........#....
..........................#......................................................#.......................#......#...........................
........................................#.............#................................#....................................................
.#......#.........................................................................................#...............................#........#
....................................#............#..........................................................................................
...............#.............#.........................................................................................#....................
............................................................................................................................................
.........................#.................................#....................................#.....#.....................................
#...........................................................................#....................................#..................#.......
.................#.....................#...................................................................................#................
........#...................................#.................#...........................#..............#..................................
......................................................#............#...............#...............#........................................
.........................................................................#..................................................................
.................................#.....................................................#......#.............................................
.........................................#.................................................................#.............#........#.........
...............#......................................................#.....#.............................................................#.
..........#....................................................#.....................................#......................................
.....#................................#...............................................................................#.....................
...........................#...............................#.................................#.........................................#....
................................#.................................................................#.........................................
..............#..........................#..................................................................#..............#................
.........#.......................................#..................................................................#.............#.........
......................................................................#.....................................................................
......................#..........................................#.....................................#....................................
#..............................................................................#.......#....................................................
..................................#.........................................................................................................
...........#..................................................#.........#..........................................#........................
.......................................#.......#..........................................#........#........#.........................#.....
....................#...............................................#.......................................................................
................................#..........#...........................................................................#....................
..#......#............................................................................................#.........#..................#........
.........................#.......................................................................#..........................#...............
...........................................................................#................................................................
................#.....................................#......#.....................................................#........................
....................................................................................................#....................................#..
.................................................................#...............#.......#..................................................
.........#..........................#...................................#...............................#...................................
..............................#................#............................................................................#..............."""

columns_to_change = []
rows_to_change = []

for column_no in range(len(sstring.splitlines()[0])):  # Noting Down Rows to Change
    current_column_elements = []

    for column_element in range(column_no, len(sstring), len(sstring.splitlines()[0])+1):
        if sstring[column_element] == "#":
            current_column_elements.append("#")
            break

    if not current_column_elements:
        columns_to_change.append(column_no)

for row_no in range(len(sstring.splitlines())):  # Noting Down Rows to Change
    row = sstring.splitlines()[row_no]
    if all(char == "." for char in row):
        rows_to_change.append(row_no)


rows_expansion = 999_999
columns_expansion = 999_999

sum_of_pair_distances = 0

for hashtag in re.finditer("\#", sstring):
    no_of_lines_before_hashtag = 0
    current_galaxy_index = hashtag.start()

    for char_before_galaxy in range(current_galaxy_index, 0, -1):
        if sstring[char_before_galaxy] == "\n":
            no_of_lines_before_hashtag += 1
        for row_no in rows_to_change:
            if no_of_lines_before_hashtag > row_no: rows_to_change.remove(rows_to_change[0])

    vertical_distance = 0
    horizontal_distance = 0
    line_length = (len(sstring.splitlines()[0]) + 1)

    for next_galaxy in range(current_galaxy_index+1, len(sstring)):
        if sstring[next_galaxy] == "\n":
            vertical_distance += 1
        elif sstring[next_galaxy] == "#":
            current_galaxy_line_index = current_galaxy_index % line_length
            next_galaxy_line_index = next_galaxy % line_length
            horizontal_distance = abs(current_galaxy_line_index - next_galaxy_line_index) + columns_expansion*sum(current_galaxy_line_index > column_no > next_galaxy_line_index or next_galaxy_line_index > column_no > current_galaxy_line_index for column_no in columns_to_change)
            sum_of_pair_distances += (vertical_distance + rows_expansion*sum([vertical_distance+no_of_lines_before_hashtag >= row_no for row_no in rows_to_change]) + horizontal_distance)

print("\n", sum_of_pair_distances)
